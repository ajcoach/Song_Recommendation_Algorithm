# -*- coding: utf-8 -*-
"""
Created on Tue Oct 19 17:33:15 2021

@author: ajc364
"""

# Python and pyspark modules required

import sys

from pyspark import SparkContext
from pyspark.sql import SparkSession
from pyspark.sql.types import *
from pyspark.sql.functions import *

from pretty import SparkPretty  # download pretty.py from LEARN
pretty = SparkPretty(limit=5)

# Required to allow the file to be submitted and run using spark-submit instead
# of using pyspark interactively

spark = SparkSession.builder.getOrCreate()
sc = SparkContext.getOrCreate()


### Question 2 a ###

mismatches_schema = StructType([
    StructField("song_id", StringType(), True),
    StructField("song_artist", StringType(), True),
    StructField("song_title", StringType(), True),
    StructField("track_id", StringType(), True),
    StructField("track_artist", StringType(), True),
    StructField("track_title", StringType(), True)
])

with open("/scratch-network/courses/2021/DATA420-21S2/data/msd/tasteprofile/mismatches/sid_matches_manually_accepted.txt", "r") as f:
    lines = f.readlines()
    sid_matches_manually_accepted = []
    for line in lines:
        if line.startswith("< ERROR: "):
            a = line[10:28]
            b = line[29:47]
            c, d = line[49:-1].split("  !=  ")
            e, f = c.split("  -  ")
            g, h = d.split("  -  ")
            sid_matches_manually_accepted.append((a, e, f, b, g, h))

matches_manually_accepted = spark.createDataFrame(sc.parallelize(sid_matches_manually_accepted, 8), schema=mismatches_schema)
matches_manually_accepted.cache()
matches_manually_accepted.show(10, 40)

""" Output
+------------------+-----------------+----------------------------------------+------------------+----------------------------------------+----------------------------------------+
|           song_id|      song_artist|                              song_title|          track_id|                            track_artist|                             track_title|
+------------------+-----------------+----------------------------------------+------------------+----------------------------------------+----------------------------------------+
|SOFQHZM12A8C142342|     Josipa Lisac|                                 razloga|TRMWMFG128F92FFEF2|                            Lisac Josipa|                            1000 razloga|
|SODXUTF12AB018A3DA|       Lutan Fyah|     Nuh Matter the Crisis Feat. Midnite|TRMWPCD12903CCE5ED|                                 Midnite|                   Nah Matter the Crisis|
|SOASCRF12A8C1372E6|Gaetano Donizetti|L'Elisir d'Amore: Act Two: Come sen v...|TRMHIPJ128F426A2E2|Gianandrea Gavazzeni_ Orchestra E Cor...|L'Elisir D'Amore_ Act 2: Come Sen Va ...|
|SOITDUN12A58A7AACA|     C.J. Chenier|                               Ay, Ai Ai|TRMHXGK128F42446AB|                         Clifton Chenier|                               Ay_ Ai Ai|
|SOLZXUM12AB018BE39|           許志安|                                男人最痛|TRMRSOF12903CCF516|                                Andy Hui|                        Nan Ren Zui Tong|
|SOTJTDT12A8C13A8A6|                S|                                       h|TRMNKQE128F427C4D8|                             Sammy Hagar|                 20th Century Man (Live)|
|SOGCVWB12AB0184CE2|                H|                                       Y|TRMUNCZ128F932A95D|                                Hawkwind|                25 Years (Alternate Mix)|
|SOKDKGD12AB0185E9C|     影山ヒロノブ|Cha-La Head-Cha-La (2005 ver./DRAGON ...|TRMOOAH12903CB4B29|                        Takahashi Hiroki|Maka fushigi adventure! (2005 Version...|
|SOPPBXP12A8C141194|    Αντώνης Ρέμος|                        O Trellos - Live|TRMXJDS128F42AE7CF|                           Antonis Remos|                               O Trellos|
|SODQSLR12A8C133A01|    John Williams|Concerto No. 1 for Guitar and String ...|TRWHMXN128F426E03C|               English Chamber Orchestra|II. Andantino siciliano from Concerto...|
+------------------+-----------------+----------------------------------------+------------------+----------------------------------------+----------------------------------------+
only showing top 10 rows

"""


print(matches_manually_accepted.count())  # 488

""" Output
488
"""

with open("/scratch-network/courses/2021/DATA420-21S2/data/msd/tasteprofile/mismatches/sid_mismatches.txt", "r") as f:
    lines = f.readlines()
    sid_mismatches = []
    for line in lines:
        if line.startswith("ERROR: "):
            a = line[8:26]
            b = line[27:45]
            c, d = line[47:-1].split("  !=  ")
            e, f = c.split("  -  ")
            g, h = d.split("  -  ")
            sid_mismatches.append((a, e, f, b, g, h))

mismatches = spark.createDataFrame(sc.parallelize(sid_mismatches, 64), schema=mismatches_schema)
mismatches.cache()
mismatches.show(10, 40)

""" Output
+------------------+-------------------+----------------------------------------+------------------+--------------+----------------------------------------+
|           song_id|        song_artist|                              song_title|          track_id|  track_artist|                             track_title|
+------------------+-------------------+----------------------------------------+------------------+--------------+----------------------------------------+
|SOUMNSI12AB0182807|Digital Underground|                        The Way We Swing|TRMMGKQ128F9325E10|      Linkwood|           Whats up with the Underground|
|SOCMRBE12AB018C546|         Jimmy Reed|The Sun Is Shining (Digitally Remaste...|TRMMREB12903CEB1B1|    Slim Harpo|               I Got Love If You Want It|
|SOLPHZY12AC468ABA8|      Africa HiTech|                                Footstep|TRMMBOC12903CEB46E|Marcus Worgull|                 Drumstern (BONUS TRACK)|
|SONGHTM12A8C1374EF|     Death in Vegas|                            Anita Berber|TRMMITP128F425D8D0|     Valen Hsu|                                  Shi Yi|
|SONGXCA12A8C13E82E| Grupo Exterminador|                           El Triunfador|TRMMAYZ128F429ECE6|     I Ribelli|                               Lei M'Ama|
|SOMBCRC12A67ADA435|      Fading Friend|                             Get us out!|TRMMNVU128EF343EED|     Masterboy|                      Feel The Heat 2000|
|SOTDWDK12A8C13617B|       Daevid Allen|                              Past Lives|TRMMNCZ128F426FF0E| Bhimsen Joshi|            Raga - Shuddha Sarang_ Aalap|
|SOEBURP12AB018C2FB|  Cristian Paduraru|                              Born Again|TRMMPBS12903CE90E1|     Yespiring|                          Journey Stages|
|SOSRJHS12A6D4FDAA3|         Jeff Mills|                      Basic Human Design|TRMWMEL128F421DA68|           M&T|                           Drumsettester|
|SOIYAAQ12A6D4F954A|           Excepter|                                      OG|TRMWHRI128F147EA8E|    The Fevers|Não Tenho Nada (Natchs Scheint Die So...|
+------------------+-------------------+----------------------------------------+------------------+--------------+----------------------------------------+
"""


print(mismatches.count())  # 19094

""" Output
19094
"""


triplets_schema = StructType([
    StructField("user_id", StringType(), True),
    StructField("song_id", StringType(), True),
    StructField("plays", IntegerType(), True)
])


triplets = (
    spark.read.format("csv")
    .option("header", "false")
    .option("delimiter", "\t")
    .option("codec", "gzip")
    .schema(triplets_schema)
    .load("hdfs:///data/msd/tasteprofile/triplets.tsv/")
    .cache()
)
triplets.cache()
triplets.show(10, 50)

""" Output
+----------------------------------------+------------------+-----+
|                                 user_id|           song_id|plays|
+----------------------------------------+------------------+-----+
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOQEFDN12AB017C52B|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOQOIUJ12A6701DAA7|    2|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOQOKKD12A6701F92E|    4|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOSDVHO12AB01882C7|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOSKICX12A6701F932|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOSNUPV12A8C13939B|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOSVMII12A6701F92D|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOTUNHI12B0B80AFE2|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOTXLTZ12AB017C535|    1|
|f1bfc2a4597a3642f232e7a4e5d5ab2a99cf80e5|SOTZDDX12A6701F935|    1|
+----------------------------------------+------------------+-----+
only showing top 10 rows
"""


mismatches_not_accepted = mismatches.join(matches_manually_accepted, on="song_id", how="left_anti")
triplets_not_mismatched = triplets.join(mismatches_not_accepted, on="song_id", how="left_anti")

print(triplets.count())                 # 48373586

""" Output
48373586
"""

print(triplets_not_mismatched.count())  # 45795111

""" Output
45795111
"""


### Question 2 b ###

# hdfs dfs -cat "/data/msd/audio/attributes/*" | awk -F',' '{print $2}' | sort | un"iq

""" Output
NUMERIC
real
real
string
string
STRING
"""

audio_attribute_type_mapping = {
  "NUMERIC": DoubleType(),
  "real": DoubleType(),
  "string": StringType(),
  "STRING": StringType()
}


audio_dataset_names = [
  "msd-jmir-area-of-moments-all-v1.0",
  "msd-jmir-lpc-all-v1.0",
  "msd-jmir-methods-of-moments-all-v1.0",
  "msd-jmir-mfcc-all-v1.0",
  "msd-jmir-spectral-all-all-v1.0",
  "msd-jmir-spectral-derivatives-all-all-v1.0",
  "msd-marsyas-timbral-v1.0",
  "msd-mvd-v1.0",
  "msd-rh-v1.0",
  "msd-rp-v1.0",
  "msd-ssd-v1.0",
  "msd-trh-v1.0",
  "msd-tssd-v1.0"
]

audio_dataset_schemas = {}
for audio_dataset_name in audio_dataset_names:
  print(audio_dataset_name)

  audio_dataset_path = f"/scratch-network/courses/2021/DATA420-21S2/data/msd/audio/attributes/{audio_dataset_name}.attributes.csv"
  with open(audio_dataset_path, "r") as f:
    rows = [line.strip().split(",") for line in f.readlines()]

  # you could rename feature columns with a short generic name

    rows[-1][0] = "track_id"
    for i, row in enumerate(rows[0:-1]):
      row[0] = f"feature_{i:04d}"

  audio_dataset_schemas[audio_dataset_name] = StructType([
    StructField(row[0], audio_attribute_type_mapping[row[1]], True) for row in rows
  ])
    
  print(audio_dataset_schemas[audio_dataset_name])
  
  
""" Output
StructType(List(StructField(feature_0000,DoubleType,true),StructField(feature_0001,DoubleType,true),StructField(feature_0002,DoubleType,true),StructField(feature_0003,DoubleType,true),StructField(feature_0004,DoubleType,true),StructField(feature_0005,DoubleType,true),StructField(feature_0006,DoubleType,true),StructField(feature_0007,DoubleType,true),StructField(feature_0008,DoubleType,true),StructField(feature_0009,DoubleType,true),StructField(feature_0010,DoubleType,true),StructField(feature_0011,DoubleType,true),StructField(feature_0012,DoubleType,true),StructField(feature_0013,DoubleType,true),StructField(feature_0014,DoubleType,true),StructField(feature_0015,DoubleType,true),StructField(feature_0016,DoubleType,true),StructField(feature_0017,DoubleType,true),StructField(feature_0018,DoubleType,true),StructField(feature_0019,DoubleType,true),StructField(feature_0020,DoubleType,true),StructField(feature_0021,DoubleType,true),StructField(feature_0022,DoubleType,true),StructField(feature_0023,DoubleType,true),StructField(feature_0024,DoubleType,true),StructField(feature_0025,DoubleType,true),StructField(feature_0026,DoubleType,true),StructField(feature_0027,DoubleType,true),StructField(feature_0028,DoubleType,true),StructField(feature_0029,DoubleType,true),StructField(feature_0030,DoubleType,true),StructField(feature_0031,DoubleType,true),StructField(feature_0032,DoubleType,true),StructField(feature_0033,DoubleType,true),StructField(feature_0034,DoubleType,true),StructField(feature_0035,DoubleType,true),StructField(feature_0036,DoubleType,true),StructField(feature_0037,DoubleType,true),StructField(feature_0038,DoubleType,true),StructField(feature_0039,DoubleType,true),StructField(feature_0040,DoubleType,true),StructField(feature_0041,DoubleType,true),StructField(feature_0042,DoubleType,true),StructField(feature_0043,DoubleType,true),StructField(feature_0044,DoubleType,true),StructField(feature_0045,DoubleType,true),StructField(feature_0046,DoubleType,true),StructField(feature_0047,DoubleType,true),StructField(feature_0048,DoubleType,true),StructField(feature_0049,DoubleType,true),StructField(feature_0050,DoubleType,true),StructField(feature_0051,DoubleType,true),StructField(feature_0052,DoubleType,true),StructField(feature_0053,DoubleType,true),StructField(feature_0054,DoubleType,true),StructField(feature_0055,DoubleType,true),StructField(feature_0056,DoubleType,true),StructField(feature_0057,DoubleType,true),StructField(feature_0058,DoubleType,true),StructField(feature_0059,DoubleType,true),StructField(feature_0060,DoubleType,true),StructField(feature_0061,DoubleType,true),StructField(feature_0062,DoubleType,true),StructField(feature_0063,DoubleType,true),StructField(feature_0064,DoubleType,true),StructField(feature_0065,DoubleType,true),StructField(feature_0066,DoubleType,true),StructField(feature_0067,DoubleType,true),StructField(feature_0068,DoubleType,true),StructField(feature_0069,DoubleType,true),StructField(feature_0070,DoubleType,true),StructField(feature_0071,DoubleType,true),StructField(feature_0072,DoubleType,true),StructField(feature_0073,DoubleType,true),StructField(feature_0074,DoubleType,true),StructField(feature_0075,DoubleType,true),StructField(feature_0076,DoubleType,true),StructField(feature_0077,DoubleType,true),StructField(feature_0078,DoubleType,true),StructField(feature_0079,DoubleType,true),StructField(feature_0080,DoubleType,true),StructField(feature_0081,DoubleType,true),StructField(feature_0082,DoubleType,true),StructField(feature_0083,DoubleType,true),StructField(feature_0084,DoubleType,true),StructField(feature_0085,DoubleType,true),StructField(feature_0086,DoubleType,true),StructField(feature_0087,DoubleType,true),StructField(feature_0088,DoubleType,true),StructField(feature_0089,DoubleType,true),StructField(feature_0090,DoubleType,true),StructField(feature_0091,DoubleType,true),StructField(feature_0092,DoubleType,true),StructField(feature_0093,DoubleType,true),StructField(feature_0094,DoubleType,true),StructField(feature_0095,DoubleType,true),StructField(feature_0096,DoubleType,true),StructField(feature_0097,DoubleType,true),StructField(feature_0098,DoubleType,true),StructField(feature_0099,DoubleType,true),StructField(feature_0100,DoubleType,true),StructField(feature_0101,DoubleType,true),StructField(feature_0102,DoubleType,true),StructField(feature_0103,DoubleType,true),StructField(feature_0104,DoubleType,true),StructField(feature_0105,DoubleType,true),StructField(feature_0106,DoubleType,true),StructField(feature_0107,DoubleType,true),StructField(feature_0108,DoubleType,true),StructField(feature_0109,DoubleType,true),StructField(feature_0110,DoubleType,true),StructField(feature_0111,DoubleType,true),StructField(feature_0112,DoubleType,true),StructField(feature_0113,DoubleType,true),StructField(feature_0114,DoubleType,true),StructField(feature_0115,DoubleType,true),StructField(feature_0116,DoubleType,true),StructField(feature_0117,DoubleType,true),StructField(feature_0118,DoubleType,true),StructField(feature_0119,DoubleType,true),StructField(feature_0120,DoubleType,true),StructField(feature_0121,DoubleType,true),StructField(feature_0122,DoubleType,true),StructField(feature_0123,DoubleType,true),StructField(feature_0124,DoubleType,true),StructField(feature_0125,DoubleType,true),StructField(feature_0126,DoubleType,true),StructField(feature_0127,DoubleType,true),StructField(feature_0128,DoubleType,true),StructField(feature_0129,DoubleType,true),StructField(feature_0130,DoubleType,true),StructField(feature_0131,DoubleType,true),StructField(feature_0132,DoubleType,true),StructField(feature_0133,DoubleType,true),StructField(feature_0134,DoubleType,true),StructField(feature_0135,DoubleType,true),StructField(feature_0136,DoubleType,true),StructField(feature_0137,DoubleType,true),StructField(feature_0138,DoubleType,true),StructField(feature_0139,DoubleType,true),StructField(feature_0140,DoubleType,true),StructField(feature_0141,DoubleType,true),StructField(feature_0142,DoubleType,true),StructField(feature_0143,DoubleType,true),StructField(feature_0144,DoubleType,true),StructField(feature_0145,DoubleType,true),StructField(feature_0146,DoubleType,true),StructField(feature_0147,DoubleType,true),StructField(feature_0148,DoubleType,true),StructField(feature_0149,DoubleType,true),StructField(feature_0150,DoubleType,true),StructField(feature_0151,DoubleType,true),StructField(feature_0152,DoubleType,true),StructField(feature_0153,DoubleType,true),StructField(feature_0154,DoubleType,true),StructField(feature_0155,DoubleType,true),StructField(feature_0156,DoubleType,true),StructField(feature_0157,DoubleType,true),StructField(feature_0158,DoubleType,true),StructField(feature_0159,DoubleType,true),StructField(feature_0160,DoubleType,true),StructField(feature_0161,DoubleType,true),StructField(feature_0162,DoubleType,true),StructField(feature_0163,DoubleType,true),StructField(feature_0164,DoubleType,true),StructField(feature_0165,DoubleType,true),StructField(feature_0166,DoubleType,true),StructField(feature_0167,DoubleType,true),StructField(feature_0168,DoubleType,true),StructField(feature_0169,DoubleType,true),StructField(feature_0170,DoubleType,true),StructField(feature_0171,DoubleType,true),StructField(feature_0172,DoubleType,true),StructField(feature_0173,DoubleType,true),StructField(feature_0174,DoubleType,true),StructField(feature_0175,DoubleType,true),StructField(feature_0176,DoubleType,true),StructField(feature_0177,DoubleType,true),StructField(feature_0178,DoubleType,true),StructField(feature_0179,DoubleType,true),StructField(feature_0180,DoubleType,true),StructField(feature_0181,DoubleType,true),StructField(feature_0182,DoubleType,true),StructField(feature_0183,DoubleType,true),StructField(feature_0184,DoubleType,true),StructField(feature_0185,DoubleType,true),StructField(feature_0186,DoubleType,true),StructField(feature_0187,DoubleType,true),StructField(feature_0188,DoubleType,true),StructField(feature_0189,DoubleType,true),StructField(feature_0190,DoubleType,true),StructField(feature_0191,DoubleType,true),StructField(feature_0192,DoubleType,true),StructField(feature_0193,DoubleType,true),StructField(feature_0194,DoubleType,true),StructField(feature_0195,DoubleType,true),StructField(feature_0196,DoubleType,true),StructField(feature_0197,DoubleType,true),StructField(feature_0198,DoubleType,true),StructField(feature_0199,DoubleType,true),StructField(feature_0200,DoubleType,true),StructField(feature_0201,DoubleType,true),StructField(feature_0202,DoubleType,true),StructField(feature_0203,DoubleType,true),StructField(feature_0204,DoubleType,true),StructField(feature_0205,DoubleType,true),StructField(feature_0206,DoubleType,true),StructField(feature_0207,DoubleType,true),StructField(feature_0208,DoubleType,true),StructField(feature_0209,DoubleType,true),StructField(feature_0210,DoubleType,true),StructField(feature_0211,DoubleType,true),StructField(feature_0212,DoubleType,true),StructField(feature_0213,DoubleType,true),StructField(feature_0214,DoubleType,true),StructField(feature_0215,DoubleType,true),StructField(feature_0216,DoubleType,true),StructField(feature_0217,DoubleType,true),StructField(feature_0218,DoubleType,true),StructField(feature_0219,DoubleType,true),StructField(feature_0220,DoubleType,true),StructField(feature_0221,DoubleType,true),StructField(feature_0222,DoubleType,true),StructField(feature_0223,DoubleType,true),StructField(feature_0224,DoubleType,true),StructField(feature_0225,DoubleType,true),StructField(feature_0226,DoubleType,true),StructField(feature_0227,DoubleType,true),StructField(feature_0228,DoubleType,true),StructField(feature_0229,DoubleType,true),StructField(feature_0230,DoubleType,true),StructField(feature_0231,DoubleType,true),StructField(feature_0232,DoubleType,true),StructField(feature_0233,DoubleType,true),StructField(feature_0234,DoubleType,true),StructField(feature_0235,DoubleType,true),StructField(feature_0236,DoubleType,true),StructField(feature_0237,DoubleType,true),StructField(feature_0238,DoubleType,true),StructField(feature_0239,DoubleType,true),StructField(feature_0240,DoubleType,true),StructField(feature_0241,DoubleType,true),StructField(feature_0242,DoubleType,true),StructField(feature_0243,DoubleType,true),StructField(feature_0244,DoubleType,true),StructField(feature_0245,DoubleType,true),StructField(feature_0246,DoubleType,true),StructField(feature_0247,DoubleType,true),StructField(feature_0248,DoubleType,true),StructField(feature_0249,DoubleType,true),StructField(feature_0250,DoubleType,true),StructField(feature_0251,DoubleType,true),StructField(feature_0252,DoubleType,true),StructField(feature_0253,DoubleType,true),StructField(feature_0254,DoubleType,true),StructField(feature_0255,DoubleType,true),StructField(feature_0256,DoubleType,true),StructField(feature_0257,DoubleType,true),StructField(feature_0258,DoubleType,true),StructField(feature_0259,DoubleType,true),StructField(feature_0260,DoubleType,true),StructField(feature_0261,DoubleType,true),StructField(feature_0262,DoubleType,true),StructField(feature_0263,DoubleType,true),StructField(feature_0264,DoubleType,true),StructField(feature_0265,DoubleType,true),StructField(feature_0266,DoubleType,true),StructField(feature_0267,DoubleType,true),StructField(feature_0268,DoubleType,true),StructField(feature_0269,DoubleType,true),StructField(feature_0270,DoubleType,true),StructField(feature_0271,DoubleType,true),StructField(feature_0272,DoubleType,true),StructField(feature_0273,DoubleType,true),StructField(feature_0274,DoubleType,true),StructField(feature_0275,DoubleType,true),StructField(feature_0276,DoubleType,true),StructField(feature_0277,DoubleType,true),StructField(feature_0278,DoubleType,true),StructField(feature_0279,DoubleType,true),StructField(feature_0280,DoubleType,true),StructField(feature_0281,DoubleType,true),StructField(feature_0282,DoubleType,true),StructField(feature_0283,DoubleType,true),StructField(feature_0284,DoubleType,true),StructField(feature_0285,DoubleType,true),StructField(feature_0286,DoubleType,true),StructField(feature_0287,DoubleType,true),StructField(feature_0288,DoubleType,true),StructField(feature_0289,DoubleType,true),StructField(feature_0290,DoubleType,true),StructField(feature_0291,DoubleType,true),StructField(feature_0292,DoubleType,true),StructField(feature_0293,DoubleType,true),StructField(feature_0294,DoubleType,true),StructField(feature_0295,DoubleType,true),StructField(feature_0296,DoubleType,true),StructField(feature_0297,DoubleType,true),StructField(feature_0298,DoubleType,true),StructField(feature_0299,DoubleType,true),StructField(feature_0300,DoubleType,true),StructField(feature_0301,DoubleType,true),StructField(feature_0302,DoubleType,true),StructField(feature_0303,DoubleType,true),StructField(feature_0304,DoubleType,true),StructField(feature_0305,DoubleType,true),StructField(feature_0306,DoubleType,true),StructField(feature_0307,DoubleType,true),StructField(feature_0308,DoubleType,true),StructField(feature_0309,DoubleType,true),StructField(feature_0310,DoubleType,true),StructField(feature_0311,DoubleType,true),StructField(feature_0312,DoubleType,true),StructField(feature_0313,DoubleType,true),StructField(feature_0314,DoubleType,true),StructField(feature_0315,DoubleType,true),StructField(feature_0316,DoubleType,true),StructField(feature_0317,DoubleType,true),StructField(feature_0318,DoubleType,true),StructField(feature_0319,DoubleType,true),StructField(feature_0320,DoubleType,true),StructField(feature_0321,DoubleType,true),StructField(feature_0322,DoubleType,true),StructField(feature_0323,DoubleType,true),StructField(feature_0324,DoubleType,true),StructField(feature_0325,DoubleType,true),StructField(feature_0326,DoubleType,true),StructField(feature_0327,DoubleType,true),StructField(feature_0328,DoubleType,true),StructField(feature_0329,DoubleType,true),StructField(feature_0330,DoubleType,true),StructField(feature_0331,DoubleType,true),StructField(feature_0332,DoubleType,true),StructField(feature_0333,DoubleType,true),StructField(feature_0334,DoubleType,true),StructField(feature_0335,DoubleType,true),StructField(feature_0336,DoubleType,true),StructField(feature_0337,DoubleType,true),StructField(feature_0338,DoubleType,true),StructField(feature_0339,DoubleType,true),StructField(feature_0340,DoubleType,true),StructField(feature_0341,DoubleType,true),StructField(feature_0342,DoubleType,true),StructField(feature_0343,DoubleType,true),StructField(feature_0344,DoubleType,true),StructField(feature_0345,DoubleType,true),StructField(feature_0346,DoubleType,true),StructField(feature_0347,DoubleType,true),StructField(feature_0348,DoubleType,true),StructField(feature_0349,DoubleType,true),StructField(feature_0350,DoubleType,true),StructField(feature_0351,DoubleType,true),StructField(feature_0352,DoubleType,true),StructField(feature_0353,DoubleType,true),StructField(feature_0354,DoubleType,true),StructField(feature_0355,DoubleType,true),StructField(feature_0356,DoubleType,true),StructField(feature_0357,DoubleType,true),StructField(feature_0358,DoubleType,true),StructField(feature_0359,DoubleType,true),StructField(feature_0360,DoubleType,true),StructField(feature_0361,DoubleType,true),StructField(feature_0362,DoubleType,true),StructField(feature_0363,DoubleType,true),StructField(feature_0364,DoubleType,true),StructField(feature_0365,DoubleType,true),StructField(feature_0366,DoubleType,true),StructField(feature_0367,DoubleType,true),StructField(feature_0368,DoubleType,true),StructField(feature_0369,DoubleType,true),StructField(feature_0370,DoubleType,true),StructField(feature_0371,DoubleType,true),StructField(feature_0372,DoubleType,true),StructField(feature_0373,DoubleType,true),StructField(feature_0374,DoubleType,true),StructField(feature_0375,DoubleType,true),StructField(feature_0376,DoubleType,true),StructField(feature_0377,DoubleType,true),StructField(feature_0378,DoubleType,true),StructField(feature_0379,DoubleType,true),StructField(feature_0380,DoubleType,true),StructField(feature_0381,DoubleType,true),StructField(feature_0382,DoubleType,true),StructField(feature_0383,DoubleType,true),StructField(feature_0384,DoubleType,true),StructField(feature_0385,DoubleType,true),StructField(feature_0386,DoubleType,true),StructField(feature_0387,DoubleType,true),StructField(feature_0388,DoubleType,true),StructField(feature_0389,DoubleType,true),StructField(feature_0390,DoubleType,true),StructField(feature_0391,DoubleType,true),StructField(feature_0392,DoubleType,true),StructField(feature_0393,DoubleType,true),StructField(feature_0394,DoubleType,true),StructField(feature_0395,DoubleType,true),StructField(feature_0396,DoubleType,true),StructField(feature_0397,DoubleType,true),StructField(feature_0398,DoubleType,true),StructField(feature_0399,DoubleType,true),StructField(feature_0400,DoubleType,true),StructField(feature_0401,DoubleType,true),StructField(feature_0402,DoubleType,true),StructField(feature_0403,DoubleType,true),StructField(feature_0404,DoubleType,true),StructField(feature_0405,DoubleType,true),StructField(feature_0406,DoubleType,true),StructField(feature_0407,DoubleType,true),StructField(feature_0408,DoubleType,true),StructField(feature_0409,DoubleType,true),StructField(feature_0410,DoubleType,true),StructField(feature_0411,DoubleType,true),StructField(feature_0412,DoubleType,true),StructField(feature_0413,DoubleType,true),StructField(feature_0414,DoubleType,true),StructField(feature_0415,DoubleType,true),StructField(feature_0416,DoubleType,true),StructField(feature_0417,DoubleType,true),StructField(feature_0418,DoubleType,true),StructField(feature_0419,DoubleType,true),StructField(feature_0420,DoubleType,true),StructField(feature_0421,DoubleType,true),StructField(feature_0422,DoubleType,true),StructField(feature_0423,DoubleType,true),StructField(feature_0424,DoubleType,true),StructField(feature_0425,DoubleType,true),StructField(feature_0426,DoubleType,true),StructField(feature_0427,DoubleType,true),StructField(feature_0428,DoubleType,true),StructField(feature_0429,DoubleType,true),StructField(feature_0430,DoubleType,true),StructField(feature_0431,DoubleType,true),StructField(feature_0432,DoubleType,true),StructField(feature_0433,DoubleType,true),StructField(feature_0434,DoubleType,true),StructField(feature_0435,DoubleType,true),StructField(feature_0436,DoubleType,true),StructField(feature_0437,DoubleType,true),StructField(feature_0438,DoubleType,true),StructField(feature_0439,DoubleType,true),StructField(feature_0440,DoubleType,true),StructField(feature_0441,DoubleType,true),StructField(feature_0442,DoubleType,true),StructField(feature_0443,DoubleType,true),StructField(feature_0444,DoubleType,true),StructField(feature_0445,DoubleType,true),StructField(feature_0446,DoubleType,true),StructField(feature_0447,DoubleType,true),StructField(feature_0448,DoubleType,true),StructField(feature_0449,DoubleType,true),StructField(feature_0450,DoubleType,true),StructField(feature_0451,DoubleType,true),StructField(feature_0452,DoubleType,true),StructField(feature_0453,DoubleType,true),StructField(feature_0454,DoubleType,true),StructField(feature_0455,DoubleType,true),StructField(feature_0456,DoubleType,true),StructField(feature_0457,DoubleType,true),StructField(feature_0458,DoubleType,true),StructField(feature_0459,DoubleType,true),StructField(feature_0460,DoubleType,true),StructField(feature_0461,DoubleType,true),StructField(feature_0462,DoubleType,true),StructField(feature_0463,DoubleType,true),StructField(feature_0464,DoubleType,true),StructField(feature_0465,DoubleType,true),StructField(feature_0466,DoubleType,true),StructField(feature_0467,DoubleType,true),StructField(feature_0468,DoubleType,true),StructField(feature_0469,DoubleType,true),StructField(feature_0470,DoubleType,true),StructField(feature_0471,DoubleType,true),StructField(feature_0472,DoubleType,true),StructField(feature_0473,DoubleType,true),StructField(feature_0474,DoubleType,true),StructField(feature_0475,DoubleType,true),StructField(feature_0476,DoubleType,true),StructField(feature_0477,DoubleType,true),StructField(feature_0478,DoubleType,true),StructField(feature_0479,DoubleType,true),StructField(feature_0480,DoubleType,true),StructField(feature_0481,DoubleType,true),StructField(feature_0482,DoubleType,true),StructField(feature_0483,DoubleType,true),StructField(feature_0484,DoubleType,true),StructField(feature_0485,DoubleType,true),StructField(feature_0486,DoubleType,true),StructField(feature_0487,DoubleType,true),StructField(feature_0488,DoubleType,true),StructField(feature_0489,DoubleType,true),StructField(feature_0490,DoubleType,true),StructField(feature_0491,DoubleType,true),StructField(feature_0492,DoubleType,true),StructField(feature_0493,DoubleType,true),StructField(feature_0494,DoubleType,true),StructField(feature_0495,DoubleType,true),StructField(feature_0496,DoubleType,true),StructField(feature_0497,DoubleType,true),StructField(feature_0498,DoubleType,true),StructField(feature_0499,DoubleType,true),StructField(feature_0500,DoubleType,true),StructField(feature_0501,DoubleType,true),StructField(feature_0502,DoubleType,true),StructField(feature_0503,DoubleType,true),StructField(feature_0504,DoubleType,true),StructField(feature_0505,DoubleType,true),StructField(feature_0506,DoubleType,true),StructField(feature_0507,DoubleType,true),StructField(feature_0508,DoubleType,true),StructField(feature_0509,DoubleType,true),StructField(feature_0510,DoubleType,true),StructField(feature_0511,DoubleType,true),StructField(feature_0512,DoubleType,true),StructField(feature_0513,DoubleType,true),StructField(feature_0514,DoubleType,true),StructField(feature_0515,DoubleType,true),StructField(feature_0516,DoubleType,true),StructField(feature_0517,DoubleType,true),StructField(feature_0518,DoubleType,true),StructField(feature_0519,DoubleType,true),StructField(feature_0520,DoubleType,true),StructField(feature_0521,DoubleType,true),StructField(feature_0522,DoubleType,true),StructField(feature_0523,DoubleType,true),StructField(feature_0524,DoubleType,true),StructField(feature_0525,DoubleType,true),StructField(feature_0526,DoubleType,true),StructField(feature_0527,DoubleType,true),StructField(feature_0528,DoubleType,true),StructField(feature_0529,DoubleType,true),StructField(feature_0530,DoubleType,true),StructField(feature_0531,DoubleType,true),StructField(feature_0532,DoubleType,true),StructField(feature_0533,DoubleType,true),StructField(feature_0534,DoubleType,true),StructField(feature_0535,DoubleType,true),StructField(feature_0536,DoubleType,true),StructField(feature_0537,DoubleType,true),StructField(feature_0538,DoubleType,true),StructField(feature_0539,DoubleType,true),StructField(feature_0540,DoubleType,true),StructField(feature_0541,DoubleType,true),StructField(feature_0542,DoubleType,true),StructField(feature_0543,DoubleType,true),StructField(feature_0544,DoubleType,true),StructField(feature_0545,DoubleType,true),StructField(feature_0546,DoubleType,true),StructField(feature_0547,DoubleType,true),StructField(feature_0548,DoubleType,true),StructField(feature_0549,DoubleType,true),StructField(feature_0550,DoubleType,true),StructField(feature_0551,DoubleType,true),StructField(feature_0552,DoubleType,true),StructField(feature_0553,DoubleType,true),StructField(feature_0554,DoubleType,true),StructField(feature_0555,DoubleType,true),StructField(feature_0556,DoubleType,true),StructField(feature_0557,DoubleType,true),StructField(feature_0558,DoubleType,true),StructField(feature_0559,DoubleType,true),StructField(feature_0560,DoubleType,true),StructField(feature_0561,DoubleType,true),StructField(feature_0562,DoubleType,true),StructField(feature_0563,DoubleType,true),StructField(feature_0564,DoubleType,true),StructField(feature_0565,DoubleType,true),StructField(feature_0566,DoubleType,true),StructField(feature_0567,DoubleType,true),StructField(feature_0568,DoubleType,true),StructField(feature_0569,DoubleType,true),StructField(feature_0570,DoubleType,true),StructField(feature_0571,DoubleType,true),StructField(feature_0572,DoubleType,true),StructField(feature_0573,DoubleType,true),StructField(feature_0574,DoubleType,true),StructField(feature_0575,DoubleType,true),StructField(feature_0576,DoubleType,true),StructField(feature_0577,DoubleType,true),StructField(feature_0578,DoubleType,true),StructField(feature_0579,DoubleType,true),StructField(feature_0580,DoubleType,true),StructField(feature_0581,DoubleType,true),StructField(feature_0582,DoubleType,true),StructField(feature_0583,DoubleType,true),StructField(feature_0584,DoubleType,true),StructField(feature_0585,DoubleType,true),StructField(feature_0586,DoubleType,true),StructField(feature_0587,DoubleType,true),StructField(feature_0588,DoubleType,true),StructField(feature_0589,DoubleType,true),StructField(feature_0590,DoubleType,true),StructField(feature_0591,DoubleType,true),StructField(feature_0592,DoubleType,true),StructField(feature_0593,DoubleType,true),StructField(feature_0594,DoubleType,true),StructField(feature_0595,DoubleType,true),StructField(feature_0596,DoubleType,true),StructField(feature_0597,DoubleType,true),StructField(feature_0598,DoubleType,true),StructField(feature_0599,DoubleType,true),StructField(feature_0600,DoubleType,true),StructField(feature_0601,DoubleType,true),StructField(feature_0602,DoubleType,true),StructField(feature_0603,DoubleType,true),StructField(feature_0604,DoubleType,true),StructField(feature_0605,DoubleType,true),StructField(feature_0606,DoubleType,true),StructField(feature_0607,DoubleType,true),StructField(feature_0608,DoubleType,true),StructField(feature_0609,DoubleType,true),StructField(feature_0610,DoubleType,true),StructField(feature_0611,DoubleType,true),StructField(feature_0612,DoubleType,true),StructField(feature_0613,DoubleType,true),StructField(feature_0614,DoubleType,true),StructField(feature_0615,DoubleType,true),StructField(feature_0616,DoubleType,true),StructField(feature_0617,DoubleType,true),StructField(feature_0618,DoubleType,true),StructField(feature_0619,DoubleType,true),StructField(feature_0620,DoubleType,true),StructField(feature_0621,DoubleType,true),StructField(feature_0622,DoubleType,true),StructField(feature_0623,DoubleType,true),StructField(feature_0624,DoubleType,true),StructField(feature_0625,DoubleType,true),StructField(feature_0626,DoubleType,true),StructField(feature_0627,DoubleType,true),StructField(feature_0628,DoubleType,true),StructField(feature_0629,DoubleType,true),StructField(feature_0630,DoubleType,true),StructField(feature_0631,DoubleType,true),StructField(feature_0632,DoubleType,true),StructField(feature_0633,DoubleType,true),StructField(feature_0634,DoubleType,true),StructField(feature_0635,DoubleType,true),StructField(feature_0636,DoubleType,true),StructField(feature_0637,DoubleType,true),StructField(feature_0638,DoubleType,true),StructField(feature_0639,DoubleType,true),StructField(feature_0640,DoubleType,true),StructField(feature_0641,DoubleType,true),StructField(feature_0642,DoubleType,true),StructField(feature_0643,DoubleType,true),StructField(feature_0644,DoubleType,true),StructField(feature_0645,DoubleType,true),StructField(feature_0646,DoubleType,true),StructField(feature_0647,DoubleType,true),StructField(feature_0648,DoubleType,true),StructField(feature_0649,DoubleType,true),StructField(feature_0650,DoubleType,true),StructField(feature_0651,DoubleType,true),StructField(feature_0652,DoubleType,true),StructField(feature_0653,DoubleType,true),StructField(feature_0654,DoubleType,true),StructField(feature_0655,DoubleType,true),StructField(feature_0656,DoubleType,true),StructField(feature_0657,DoubleType,true),StructField(feature_0658,DoubleType,true),StructField(feature_0659,DoubleType,true),StructField(feature_0660,DoubleType,true),StructField(feature_0661,DoubleType,true),StructField(feature_0662,DoubleType,true),StructField(feature_0663,DoubleType,true),StructField(feature_0664,DoubleType,true),StructField(feature_0665,DoubleType,true),StructField(feature_0666,DoubleType,true),StructField(feature_0667,DoubleType,true),StructField(feature_0668,DoubleType,true),StructField(feature_0669,DoubleType,true),StructField(feature_0670,DoubleType,true),StructField(feature_0671,DoubleType,true),StructField(feature_0672,DoubleType,true),StructField(feature_0673,DoubleType,true),StructField(feature_0674,DoubleType,true),StructField(feature_0675,DoubleType,true),StructField(feature_0676,DoubleType,true),StructField(feature_0677,DoubleType,true),StructField(feature_0678,DoubleType,true),StructField(feature_0679,DoubleType,true),StructField(feature_0680,DoubleType,true),StructField(feature_0681,DoubleType,true),StructField(feature_0682,DoubleType,true),StructField(feature_0683,DoubleType,true),StructField(feature_0684,DoubleType,true),StructField(feature_0685,DoubleType,true),StructField(feature_0686,DoubleType,true),StructField(feature_0687,DoubleType,true),StructField(feature_0688,DoubleType,true),StructField(feature_0689,DoubleType,true),StructField(feature_0690,DoubleType,true),StructField(feature_0691,DoubleType,true),StructField(feature_0692,DoubleType,true),StructField(feature_0693,DoubleType,true),StructField(feature_0694,DoubleType,true),StructField(feature_0695,DoubleType,true),StructField(feature_0696,DoubleType,true),StructField(feature_0697,DoubleType,true),StructField(feature_0698,DoubleType,true),StructField(feature_0699,DoubleType,true),StructField(feature_0700,DoubleType,true),StructField(feature_0701,DoubleType,true),StructField(feature_0702,DoubleType,true),StructField(feature_0703,DoubleType,true),StructField(feature_0704,DoubleType,true),StructField(feature_0705,DoubleType,true),StructField(feature_0706,DoubleType,true),StructField(feature_0707,DoubleType,true),StructField(feature_0708,DoubleType,true),StructField(feature_0709,DoubleType,true),StructField(feature_0710,DoubleType,true),StructField(feature_0711,DoubleType,true),StructField(feature_0712,DoubleType,true),StructField(feature_0713,DoubleType,true),StructField(feature_0714,DoubleType,true),StructField(feature_0715,DoubleType,true),StructField(feature_0716,DoubleType,true),StructField(feature_0717,DoubleType,true),StructField(feature_0718,DoubleType,true),StructField(feature_0719,DoubleType,true),StructField(feature_0720,DoubleType,true),StructField(feature_0721,DoubleType,true),StructField(feature_0722,DoubleType,true),StructField(feature_0723,DoubleType,true),StructField(feature_0724,DoubleType,true),StructField(feature_0725,DoubleType,true),StructField(feature_0726,DoubleType,true),StructField(feature_0727,DoubleType,true),StructField(feature_0728,DoubleType,true),StructField(feature_0729,DoubleType,true),StructField(feature_0730,DoubleType,true),StructField(feature_0731,DoubleType,true),StructField(feature_0732,DoubleType,true),StructField(feature_0733,DoubleType,true),StructField(feature_0734,DoubleType,true),StructField(feature_0735,DoubleType,true),StructField(feature_0736,DoubleType,true),StructField(feature_0737,DoubleType,true),StructField(feature_0738,DoubleType,true),StructField(feature_0739,DoubleType,true),StructField(feature_0740,DoubleType,true),StructField(feature_0741,DoubleType,true),StructField(feature_0742,DoubleType,true),StructField(feature_0743,DoubleType,true),StructField(feature_0744,DoubleType,true),StructField(feature_0745,DoubleType,true),StructField(feature_0746,DoubleType,true),StructField(feature_0747,DoubleType,true),StructField(feature_0748,DoubleType,true),StructField(feature_0749,DoubleType,true),StructField(feature_0750,DoubleType,true),StructField(feature_0751,DoubleType,true),StructField(feature_0752,DoubleType,true),StructField(feature_0753,DoubleType,true),StructField(feature_0754,DoubleType,true),StructField(feature_0755,DoubleType,true),StructField(feature_0756,DoubleType,true),StructField(feature_0757,DoubleType,true),StructField(feature_0758,DoubleType,true),StructField(feature_0759,DoubleType,true),StructField(feature_0760,DoubleType,true),StructField(feature_0761,DoubleType,true),StructField(feature_0762,DoubleType,true),StructField(feature_0763,DoubleType,true),StructField(feature_0764,DoubleType,true),StructField(feature_0765,DoubleType,true),StructField(feature_0766,DoubleType,true),StructField(feature_0767,DoubleType,true),StructField(feature_0768,DoubleType,true),StructField(feature_0769,DoubleType,true),StructField(feature_0770,DoubleType,true),StructField(feature_0771,DoubleType,true),StructField(feature_0772,DoubleType,true),StructField(feature_0773,DoubleType,true),StructField(feature_0774,DoubleType,true),StructField(feature_0775,DoubleType,true),StructField(feature_0776,DoubleType,true),StructField(feature_0777,DoubleType,true),StructField(feature_0778,DoubleType,true),StructField(feature_0779,DoubleType,true),StructField(feature_0780,DoubleType,true),StructField(feature_0781,DoubleType,true),StructField(feature_0782,DoubleType,true),StructField(feature_0783,DoubleType,true),StructField(feature_0784,DoubleType,true),StructField(feature_0785,DoubleType,true),StructField(feature_0786,DoubleType,true),StructField(feature_0787,DoubleType,true),StructField(feature_0788,DoubleType,true),StructField(feature_0789,DoubleType,true),StructField(feature_0790,DoubleType,true),StructField(feature_0791,DoubleType,true),StructField(feature_0792,DoubleType,true),StructField(feature_0793,DoubleType,true),StructField(feature_0794,DoubleType,true),StructField(feature_0795,DoubleType,true),StructField(feature_0796,DoubleType,true),StructField(feature_0797,DoubleType,true),StructField(feature_0798,DoubleType,true),StructField(feature_0799,DoubleType,true),StructField(feature_0800,DoubleType,true),StructField(feature_0801,DoubleType,true),StructField(feature_0802,DoubleType,true),StructField(feature_0803,DoubleType,true),StructField(feature_0804,DoubleType,true),StructField(feature_0805,DoubleType,true),StructField(feature_0806,DoubleType,true),StructField(feature_0807,DoubleType,true),StructField(feature_0808,DoubleType,true),StructField(feature_0809,DoubleType,true),StructField(feature_0810,DoubleType,true),StructField(feature_0811,DoubleType,true),StructField(feature_0812,DoubleType,true),StructField(feature_0813,DoubleType,true),StructField(feature_0814,DoubleType,true),StructField(feature_0815,DoubleType,true),StructField(feature_0816,DoubleType,true),StructField(feature_0817,DoubleType,true),StructField(feature_0818,DoubleType,true),StructField(feature_0819,DoubleType,true),StructField(feature_0820,DoubleType,true),StructField(feature_0821,DoubleType,true),StructField(feature_0822,DoubleType,true),StructField(feature_0823,DoubleType,true),StructField(feature_0824,DoubleType,true),StructField(feature_0825,DoubleType,true),StructField(feature_0826,DoubleType,true),StructField(feature_0827,DoubleType,true),StructField(feature_0828,DoubleType,true),StructField(feature_0829,DoubleType,true),StructField(feature_0830,DoubleType,true),StructField(feature_0831,DoubleType,true),StructField(feature_0832,DoubleType,true),StructField(feature_0833,DoubleType,true),StructField(feature_0834,DoubleType,true),StructField(feature_0835,DoubleType,true),StructField(feature_0836,DoubleType,true),StructField(feature_0837,DoubleType,true),StructField(feature_0838,DoubleType,true),StructField(feature_0839,DoubleType,true),StructField(feature_0840,DoubleType,true),StructField(feature_0841,DoubleType,true),StructField(feature_0842,DoubleType,true),StructField(feature_0843,DoubleType,true),StructField(feature_0844,DoubleType,true),StructField(feature_0845,DoubleType,true),StructField(feature_0846,DoubleType,true),StructField(feature_0847,DoubleType,true),StructField(feature_0848,DoubleType,true),StructField(feature_0849,DoubleType,true),StructField(feature_0850,DoubleType,true),StructField(feature_0851,DoubleType,true),StructField(feature_0852,DoubleType,true),StructField(feature_0853,DoubleType,true),StructField(feature_0854,DoubleType,true),StructField(feature_0855,DoubleType,true),StructField(feature_0856,DoubleType,true),StructField(feature_0857,DoubleType,true),StructField(feature_0858,DoubleType,true),StructField(feature_0859,DoubleType,true),StructField(feature_0860,DoubleType,true),StructField(feature_0861,DoubleType,true),StructField(feature_0862,DoubleType,true),StructField(feature_0863,DoubleType,true),StructField(feature_0864,DoubleType,true),StructField(feature_0865,DoubleType,true),StructField(feature_0866,DoubleType,true),StructField(feature_0867,DoubleType,true),StructField(feature_0868,DoubleType,true),StructField(feature_0869,DoubleType,true),StructField(feature_0870,DoubleType,true),StructField(feature_0871,DoubleType,true),StructField(feature_0872,DoubleType,true),StructField(feature_0873,DoubleType,true),StructField(feature_0874,DoubleType,true),StructField(feature_0875,DoubleType,true),StructField(feature_0876,DoubleType,true),StructField(feature_0877,DoubleType,true),StructField(feature_0878,DoubleType,true),StructField(feature_0879,DoubleType,true),StructField(feature_0880,DoubleType,true),StructField(feature_0881,DoubleType,true),StructField(feature_0882,DoubleType,true),StructField(feature_0883,DoubleType,true),StructField(feature_0884,DoubleType,true),StructField(feature_0885,DoubleType,true),StructField(feature_0886,DoubleType,true),StructField(feature_0887,DoubleType,true),StructField(feature_0888,DoubleType,true),StructField(feature_0889,DoubleType,true),StructField(feature_0890,DoubleType,true),StructField(feature_0891,DoubleType,true),StructField(feature_0892,DoubleType,true),StructField(feature_0893,DoubleType,true),StructField(feature_0894,DoubleType,true),StructField(feature_0895,DoubleType,true),StructField(feature_0896,DoubleType,true),StructField(feature_0897,DoubleType,true),StructField(feature_0898,DoubleType,true),StructField(feature_0899,DoubleType,true),StructField(feature_0900,DoubleType,true),StructField(feature_0901,DoubleType,true),StructField(feature_0902,DoubleType,true),StructField(feature_0903,DoubleType,true),StructField(feature_0904,DoubleType,true),StructField(feature_0905,DoubleType,true),StructField(feature_0906,DoubleType,true),StructField(feature_0907,DoubleType,true),StructField(feature_0908,DoubleType,true),StructField(feature_0909,DoubleType,true),StructField(feature_0910,DoubleType,true),StructField(feature_0911,DoubleType,true),StructField(feature_0912,DoubleType,true),StructField(feature_0913,DoubleType,true),StructField(feature_0914,DoubleType,true),StructField(feature_0915,DoubleType,true),StructField(feature_0916,DoubleType,true),StructField(feature_0917,DoubleType,true),StructField(feature_0918,DoubleType,true),StructField(feature_0919,DoubleType,true),StructField(feature_0920,DoubleType,true),StructField(feature_0921,DoubleType,true),StructField(feature_0922,DoubleType,true),StructField(feature_0923,DoubleType,true),StructField(feature_0924,DoubleType,true),StructField(feature_0925,DoubleType,true),StructField(feature_0926,DoubleType,true),StructField(feature_0927,DoubleType,true),StructField(feature_0928,DoubleType,true),StructField(feature_0929,DoubleType,true),StructField(feature_0930,DoubleType,true),StructField(feature_0931,DoubleType,true),StructField(feature_0932,DoubleType,true),StructField(feature_0933,DoubleType,true),StructField(feature_0934,DoubleType,true),StructField(feature_0935,DoubleType,true),StructField(feature_0936,DoubleType,true),StructField(feature_0937,DoubleType,true),StructField(feature_0938,DoubleType,true),StructField(feature_0939,DoubleType,true),StructField(feature_0940,DoubleType,true),StructField(feature_0941,DoubleType,true),StructField(feature_0942,DoubleType,true),StructField(feature_0943,DoubleType,true),StructField(feature_0944,DoubleType,true),StructField(feature_0945,DoubleType,true),StructField(feature_0946,DoubleType,true),StructField(feature_0947,DoubleType,true),StructField(feature_0948,DoubleType,true),StructField(feature_0949,DoubleType,true),StructField(feature_0950,DoubleType,true),StructField(feature_0951,DoubleType,true),StructField(feature_0952,DoubleType,true),StructField(feature_0953,DoubleType,true),StructField(feature_0954,DoubleType,true),StructField(feature_0955,DoubleType,true),StructField(feature_0956,DoubleType,true),StructField(feature_0957,DoubleType,true),StructField(feature_0958,DoubleType,true),StructField(feature_0959,DoubleType,true),StructField(feature_0960,DoubleType,true),StructField(feature_0961,DoubleType,true),StructField(feature_0962,DoubleType,true),StructField(feature_0963,DoubleType,true),StructField(feature_0964,DoubleType,true),StructField(feature_0965,DoubleType,true),StructField(feature_0966,DoubleType,true),StructField(feature_0967,DoubleType,true),StructField(feature_0968,DoubleType,true),StructField(feature_0969,DoubleType,true),StructField(feature_0970,DoubleType,true),StructField(feature_0971,DoubleType,true),StructField(feature_0972,DoubleType,true),StructField(feature_0973,DoubleType,true),StructField(feature_0974,DoubleType,true),StructField(feature_0975,DoubleType,true),StructField(feature_0976,DoubleType,true),StructField(feature_0977,DoubleType,true),StructField(feature_0978,DoubleType,true),StructField(feature_0979,DoubleType,true),StructField(feature_0980,DoubleType,true),StructField(feature_0981,DoubleType,true),StructField(feature_0982,DoubleType,true),StructField(feature_0983,DoubleType,true),StructField(feature_0984,DoubleType,true),StructField(feature_0985,DoubleType,true),StructField(feature_0986,DoubleType,true),StructField(feature_0987,DoubleType,true),StructField(feature_0988,DoubleType,true),StructField(feature_0989,DoubleType,true),StructField(feature_0990,DoubleType,true),StructField(feature_0991,DoubleType,true),StructField(feature_0992,DoubleType,true),StructField(feature_0993,DoubleType,true),StructField(feature_0994,DoubleType,true),StructField(feature_0995,DoubleType,true),StructField(feature_0996,DoubleType,true),StructField(feature_0997,DoubleType,true),StructField(feature_0998,DoubleType,true),StructField(feature_0999,DoubleType,true),StructField(feature_1000,DoubleType,true),StructField(feature_1001,DoubleType,true),StructField(feature_1002,DoubleType,true),StructField(feature_1003,DoubleType,true),StructField(feature_1004,DoubleType,true),StructField(feature_1005,DoubleType,true),StructField(feature_1006,DoubleType,true),StructField(feature_1007,DoubleType,true),StructField(feature_1008,DoubleType,true),StructField(feature_1009,DoubleType,true),StructField(feature_1010,DoubleType,true),StructField(feature_1011,DoubleType,true),StructField(feature_1012,DoubleType,true),StructField(feature_1013,DoubleType,true),StructField(feature_1014,DoubleType,true),StructField(feature_1015,DoubleType,true),StructField(feature_1016,DoubleType,true),StructField(feature_1017,DoubleType,true),StructField(feature_1018,DoubleType,true),StructField(feature_1019,DoubleType,true),StructField(feature_1020,DoubleType,true),StructField(feature_1021,DoubleType,true),StructField(feature_1022,DoubleType,true),StructField(feature_1023,DoubleType,true),StructField(feature_1024,DoubleType,true),StructField(feature_1025,DoubleType,true),StructField(feature_1026,DoubleType,true),StructField(feature_1027,DoubleType,true),StructField(feature_1028,DoubleType,true),StructField(feature_1029,DoubleType,true),StructField(feature_1030,DoubleType,true),StructField(feature_1031,DoubleType,true),StructField(feature_1032,DoubleType,true),StructField(feature_1033,DoubleType,true),StructField(feature_1034,DoubleType,true),StructField(feature_1035,DoubleType,true),StructField(feature_1036,DoubleType,true),StructField(feature_1037,DoubleType,true),StructField(feature_1038,DoubleType,true),StructField(feature_1039,DoubleType,true),StructField(feature_1040,DoubleType,true),StructField(feature_1041,DoubleType,true),StructField(feature_1042,DoubleType,true),StructField(feature_1043,DoubleType,true),StructField(feature_1044,DoubleType,true),StructField(feature_1045,DoubleType,true),StructField(feature_1046,DoubleType,true),StructField(feature_1047,DoubleType,true),StructField(feature_1048,DoubleType,true),StructField(feature_1049,DoubleType,true),StructField(feature_1050,DoubleType,true),StructField(feature_1051,DoubleType,true),StructField(feature_1052,DoubleType,true),StructField(feature_1053,DoubleType,true),StructField(feature_1054,DoubleType,true),StructField(feature_1055,DoubleType,true),StructField(feature_1056,DoubleType,true),StructField(feature_1057,DoubleType,true),StructField(feature_1058,DoubleType,true),StructField(feature_1059,DoubleType,true),StructField(feature_1060,DoubleType,true),StructField(feature_1061,DoubleType,true),StructField(feature_1062,DoubleType,true),StructField(feature_1063,DoubleType,true),StructField(feature_1064,DoubleType,true),StructField(feature_1065,DoubleType,true),StructField(feature_1066,DoubleType,true),StructField(feature_1067,DoubleType,true),StructField(feature_1068,DoubleType,true),StructField(feature_1069,DoubleType,true),StructField(feature_1070,DoubleType,true),StructField(feature_1071,DoubleType,true),StructField(feature_1072,DoubleType,true),StructField(feature_1073,DoubleType,true),StructField(feature_1074,DoubleType,true),StructField(feature_1075,DoubleType,true),StructField(feature_1076,DoubleType,true),StructField(feature_1077,DoubleType,true),StructField(feature_1078,DoubleType,true),StructField(feature_1079,DoubleType,true),StructField(feature_1080,DoubleType,true),StructField(feature_1081,DoubleType,true),StructField(feature_1082,DoubleType,true),StructField(feature_1083,DoubleType,true),StructField(feature_1084,DoubleType,true),StructField(feature_1085,DoubleType,true),StructField(feature_1086,DoubleType,true),StructField(feature_1087,DoubleType,true),StructField(feature_1088,DoubleType,true),StructField(feature_1089,DoubleType,true),StructField(feature_1090,DoubleType,true),StructField(feature_1091,DoubleType,true),StructField(feature_1092,DoubleType,true),StructField(feature_1093,DoubleType,true),StructField(feature_1094,DoubleType,true),StructField(feature_1095,DoubleType,true),StructField(feature_1096,DoubleType,true),StructField(feature_1097,DoubleType,true),StructField(feature_1098,DoubleType,true),StructField(feature_1099,DoubleType,true),StructField(feature_1100,DoubleType,true),StructField(feature_1101,DoubleType,true),StructField(feature_1102,DoubleType,true),StructField(feature_1103,DoubleType,true),StructField(feature_1104,DoubleType,true),StructField(feature_1105,DoubleType,true),StructField(feature_1106,DoubleType,true),StructField(feature_1107,DoubleType,true),StructField(feature_1108,DoubleType,true),StructField(feature_1109,DoubleType,true),StructField(feature_1110,DoubleType,true),StructField(feature_1111,DoubleType,true),StructField(feature_1112,DoubleType,true),StructField(feature_1113,DoubleType,true),StructField(feature_1114,DoubleType,true),StructField(feature_1115,DoubleType,true),StructField(feature_1116,DoubleType,true),StructField(feature_1117,DoubleType,true),StructField(feature_1118,DoubleType,true),StructField(feature_1119,DoubleType,true),StructField(feature_1120,DoubleType,true),StructField(feature_1121,DoubleType,true),StructField(feature_1122,DoubleType,true),StructField(feature_1123,DoubleType,true),StructField(feature_1124,DoubleType,true),StructField(feature_1125,DoubleType,true),StructField(feature_1126,DoubleType,true),StructField(feature_1127,DoubleType,true),StructField(feature_1128,DoubleType,true),StructField(feature_1129,DoubleType,true),StructField(feature_1130,DoubleType,true),StructField(feature_1131,DoubleType,true),StructField(feature_1132,DoubleType,true),StructField(feature_1133,DoubleType,true),StructField(feature_1134,DoubleType,true),StructField(feature_1135,DoubleType,true),StructField(feature_1136,DoubleType,true),StructField(feature_1137,DoubleType,true),StructField(feature_1138,DoubleType,true),StructField(feature_1139,DoubleType,true),StructField(feature_1140,DoubleType,true),StructField(feature_1141,DoubleType,true),StructField(feature_1142,DoubleType,true),StructField(feature_1143,DoubleType,true),StructField(feature_1144,DoubleType,true),StructField(feature_1145,DoubleType,true),StructField(feature_1146,DoubleType,true),StructField(feature_1147,DoubleType,true),StructField(feature_1148,DoubleType,true),StructField(feature_1149,DoubleType,true),StructField(feature_1150,DoubleType,true),StructField(feature_1151,DoubleType,true),StructField(feature_1152,DoubleType,true),StructField(feature_1153,DoubleType,true),StructField(feature_1154,DoubleType,true),StructField(feature_1155,DoubleType,true),StructField(feature_1156,DoubleType,true),StructField(feature_1157,DoubleType,true),StructField(feature_1158,DoubleType,true),StructField(feature_1159,DoubleType,true),StructField(feature_1160,DoubleType,true),StructField(feature_1161,DoubleType,true),StructField(feature_1162,DoubleType,true),StructField(feature_1163,DoubleType,true),StructField(feature_1164,DoubleType,true),StructField(feature_1165,DoubleType,true),StructField(feature_1166,DoubleType,true),StructField(feature_1167,DoubleType,true),StructField(feature_1168,DoubleType,true),StructField(feature_1169,DoubleType,true),StructField(feature_1170,DoubleType,true),StructField(feature_1171,DoubleType,true),StructField(feature_1172,DoubleType,true),StructField(feature_1173,DoubleType,true),StructField(feature_1174,DoubleType,true),StructField(feature_1175,DoubleType,true),StructField(track_id,StringType,true)))

"""



# you can now use these schemas to load any one of the above datasets, e.g.

audio_dataset_name = "msd-mvd-v1.0"

schema = audio_dataset_schemas[audio_dataset_name]
data = spark.read.format("com.databricks.spark.csv") \
    .option("header", "true") \
    .option("inferSchema", "false") \
    .schema(schema) \
    .load(f"hdfs:///data/msd/audio/features/{audio_dataset_name}.csv")

data.cache()
print(pretty(data.head().asDict()))

""" Output
{
  'MSD_TRACKID': "'TRHFHYX12903CAF953'",
  'Method_of_Moments_Overall_Average_1': 0.2661,
  'Method_of_Moments_Overall_Average_2': 30.26,
  'Method_of_Moments_Overall_Average_3': 1829.0,
  'Method_of_Moments_Overall_Average_4': 183800.0,
  'Method_of_Moments_Overall_Average_5': 31230000.0,
  'Method_of_Moments_Overall_Standard_Deviation_1': 0.1195,
  'Method_of_Moments_Overall_Standard_Deviation_2': 13.02,
  'Method_of_Moments_Overall_Standard_Deviation_3': 611.9,
  'Method_of_Moments_Overall_Standard_Deviation_4': 43880.0,
  'Method_of_Moments_Overall_Standard_Deviation_5': 7226000.0
}
"""


audio_dataset_schemas.keys()

""" Output
dict_keys(['msd-jmir-area-of-moments-all-v1.0', 'msd-jmir-lpc-all-v1.0', 'msd-jmir-methods-of-moments-all-v1.0', 'msd-jmir-mfcc-all-v1.0', 'msd-jmir-spectral-all-all-v1.0', 'msd-jmir-spectral-derivatives-all-all-v1.0', 'msd-marsyas-timbral-v1.0', 'msd-mvd-v1.0', 'msd-rh-v1.0', 'msd-rp-v1.0', 'msd-ssd-v1.0', 'msd-trh-v1.0', 'msd-tssd-v1.0'])
"""
